{
  "facts": [{
    "@type": "type.googleapis.com/NotificationPosted",
    "record": {
    },
    "customContextDataKey": {
    },
    "id": "F-8a26e28c-96bf-4bc6-bded-e81c7daa5e4b"
  }],
  "conditions": [{
    "@type": "type.googleapis.com/MatchMVEL",
    "expression": "import java.util.regex.Matcher;\nimport java.util.regex.Pattern;\n\nString msgText \u003d {contentText};\nString[] keyword \u003d {\"éªŒè¯ç \", \"æ ¡éªŒç \", \"æ£€éªŒç \", \"ç¡®è®¤ç \", \"æ¿€æ´»ç \", \"åŠ¨æ€ç \", \"å®‰å…¨ç \", \"éªŒè¯ä»£ç \", \"æ ¡éªŒä»£ç \", \"æ£€éªŒä»£ç \", \"æ¿€æ´»ä»£ç \", \"ç¡®è®¤ä»£ç \", \"åŠ¨æ€ä»£ç \", \"å®‰å…¨ä»£ç \", \"ç™»å…¥ç \", \"è®¤è¯ç \", \"è¯†åˆ«ç \", \"çŸ­ä¿¡å£ä»¤\", \"åŠ¨æ€å¯†ç \", \"äº¤æ˜“ç \", \"ä¸Šç½‘å¯†ç \", \"éšæœºç \", \"åŠ¨æ€å£ä»¤\", \"é©—è­‰ç¢¼\", \"æ ¡é©—ç¢¼\", \"æª¢é©—ç¢¼\", \"ç¢ºèªç¢¼\", \"æ¿€æ´»ç¢¼\", \"å‹•æ…‹ç¢¼\", \"é©—è­‰ä»£ç¢¼\", \"æ ¡é©—ä»£ç¢¼\", \"æª¢é©—ä»£ç¢¼\", \"ç¢ºèªä»£ç¢¼\", \"æ¿€æ´»ä»£ç¢¼\", \"å‹•æ…‹ä»£ç¢¼\", \"ç™»å…¥ç¢¼\", \"èªè­‰ç¢¼\", \"è­˜åˆ¥ç¢¼\", \"Code\", \"code\", \"CODE\"};\n\nboolean containsMatch \u003d false;\n\nforeach (String keywordList : keyword) {\n    if (!containsMatch) {\n        Pattern pattern \u003d Pattern.compile(\".*\" + keywordList + \".*\");\n        Matcher matcher \u003d pattern.matcher(msgText);\n\n        if (matcher.find()) {\n            containsMatch \u003d true;\n        }\n    }\n}\n\nreturn containsMatch;",
    "customContextDataKey": {
    },
    "id": "C-ebec854c-5fe7-4bd4-ba12-03869e0e8649"
  }, {
    "@type": "type.googleapis.com/CurrentPkgList",
    "pkgSets": ["SMS code blacklist"],
    "op": "ANY",
    "customContextDataKey": {
    },
    "isInvert": true,
    "id": "C-12621775-f6fd-4fe7-affc-5facb4357406"
  }],
  "actions": [{
    "@type": "type.googleapis.com/ExecuteMVEL",
    "expression": "import java.util.regex.Matcher;\nimport java.util.regex.Pattern;\n\nString msgText \u003d {contentText};\n\n// å…³é”®è¯æ•°ç»„\nkeywords \u003d [\"éªŒè¯ç \", \"æ ¡éªŒç \", \"æ£€éªŒç \", \"ç¡®è®¤ç \", \"æ¿€æ´»ç \", \"åŠ¨æ€ç \", \"å®‰å…¨ç \", \"éªŒè¯ä»£ç \", \"æ ¡éªŒä»£ç \", \"æ£€éªŒä»£ç \", \"æ¿€æ´»ä»£ç \", \"ç¡®è®¤ä»£ç \", \"åŠ¨æ€ä»£ç \", \"å®‰å…¨ä»£ç \", \"ç™»å…¥ç \", \"è®¤è¯ç \", \"è¯†åˆ«ç \", \"çŸ­ä¿¡å£ä»¤\", \"åŠ¨æ€å¯†ç \", \"äº¤æ˜“ç \", \"ä¸Šç½‘å¯†ç \", \"éšæœºç \", \"åŠ¨æ€å£ä»¤\", \"é©—è­‰ç¢¼\", \"æ ¡é©—ç¢¼\", \"æª¢é©—ç¢¼\", \"ç¢ºèªç¢¼\", \"æ¿€æ´»ç¢¼\", \"å‹•æ…‹ç¢¼\", \"é©—è­‰ä»£ç¢¼\", \"æ ¡é©—ä»£ç¢¼\", \"æª¢é©—ä»£ç¢¼\", \"ç¢ºèªä»£ç¢¼\", \"æ¿€æ´»ä»£ç¢¼\", \"å‹•æ…‹ä»£ç¢¼\", \"ç™»å…¥ç¢¼\", \"èªè­‰ç¢¼\", \"è­˜åˆ¥ç¢¼\", \"Code\", \"code\", \"CODE\"];\n\n// æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…4åˆ°10ä½çš„æ•°å­—åºåˆ—\nPattern pattern \u003d Pattern.compile(\"\\\\d{4,10}\");\nMatcher matcher \u003d pattern.matcher(msgText);\n\n// ç”¨äºå­˜å‚¨æœ€è¿‘çš„PINç å€¼\nclosestPinCode \u003d null;\nclosestDistance \u003d Integer.MAX_VALUE;\n\n// éå†æ‰€æœ‰å…³é”®è¯\nfor (keyword : keywords) {\n    keywordPosition \u003d msgText.indexOf(keyword);\n    if (keywordPosition !\u003d -1) {\n\n        // éå†æ‰€æœ‰åŒ¹é…çš„PINç \n        while (matcher.find()) {\n            pinCodePosition \u003d matcher.start();\n\n            // è®¡ç®—PINç ä¸å…³é”®è¯ä¹‹é—´çš„è·ç¦»\n            distance \u003d Math.abs(pinCodePosition - keywordPosition);\n\n            // å¦‚æœè¿™ä¸ªPINç æ¯”å½“å‰å­˜å‚¨çš„æ›´æ¥è¿‘ï¼Œæ›´æ–°æœ€è¿‘çš„PINç \n            if (distance \u003c closestDistance) {\n                closestDistance \u003d distance;\n                closestPinCode \u003d matcher.group();\n            }\n        }\n\n        // é‡ç½®matcherä»¥ä¾¿ä¸‹ä¸€æ¬¡å¾ªç¯ä½¿ç”¨\n        matcher.reset();\n    }\n}\n\n// è¿”å›æœ€è¿‘çš„PINç å€¼ï¼Œå¦‚æœæœªæ‰¾åˆ°åˆ™è¿”å›false\nreturn closestPinCode !\u003d null ? closestPinCode : false;",
    "customContextDataKey": {
    },
    "note": "åŒ¹é…4-10ä½æ•°å­—çš„éªŒè¯ç ",
    "id": "A-d05cf66f-7733-43c6-ba91-449264ffe2a1"
  }, {
    "@type": "type.googleapis.com/IfThenElse",
    "If": [{
      "@type": "type.googleapis.com/MatchMVEL",
      "expression": "{mvelRet} \u003d\u003d false;",
      "customContextDataKey": {
      },
      "id": "C-850c39c4-a84d-4b0d-bdcf-37ccc52e1c50"
    }],
    "IfActions": [{
      "@type": "type.googleapis.com/ShowToast",
      "message": "æå–éªŒè¯ç å¤±è´¥",
      "customContextDataKey": {
      },
      "id": "A-2de14ea0-8308-4f3e-a6d4-0d843e607f6e"
    }],
    "ElseActions": [{
      "@type": "type.googleapis.com/CreateLocalVar",
      "localVar": {
        "name": "éªŒè¯ç ",
        "type": {
          "@type": "type.googleapis.com/StringVar"
        }
      },
      "customContextDataKey": {
      },
      "id": "A-77431946-34ec-47de-8bcc-0d518111f872"
    }, {
      "@type": "type.googleapis.com/WriteLocalVar",
      "varName": "éªŒè¯ç ",
      "valueAsString": "{mvelRet}",
      "customContextDataKey": {
      },
      "id": "A-2dfb7515-66a7-4de6-aaae-0e5c374a34f9"
    }, {
      "@type": "type.googleapis.com/ShowStatusBarChip",
      "text": "ğŸ“„localVarOf$éªŒè¯ç ",
      "clickAction": [{
        "@type": "type.googleapis.com/ShellCommand",
        "command": "#!/bin/bash\n\n# è¾“å…¥æ–‡æœ¬\ntext\u003d\"localVarOf$éªŒè¯ç \"\n\n# ä½¿ç”¨foldå‘½ä»¤å°†æ¯ä¸ªå­—ç¬¦æ‹†åˆ†åˆ°ä¸€è¡Œï¼Œå¹¶ä½¿ç”¨whileå¾ªç¯é€è¡Œå¤„ç†\necho \"$text\" | awk \u0027{for(i\u003d1;i\u003c\u003dlength;i++) print substr($0,i,1)}\u0027 | while IFS\u003d read -r char; do\n    input text \"$char\"\ndone\n",
        "customContextDataKey": {
        },
        "id": "A-ac87643a-4ff5-48f2-97c8-514135e6832d"
      }, {
        "@type": "type.googleapis.com/HideStatusBarClip",
        "customContextDataKey": {
        },
        "id": "A-d8adb4df-2219-4c03-ac9e-02505308f452"
      }],
      "customContextDataKey": {
      },
      "id": "A-29db015e-2977-4b9a-a51a-782f5f1295e1"
    }, {
      "@type": "type.googleapis.com/Delay",
      "timeString": "3000",
      "customContextDataKey": {
      },
      "id": "A-b24b0882-1e2c-43d9-a0c3-b04b4675ac9f"
    }, {
      "@type": "type.googleapis.com/HideStatusBarClip",
      "customContextDataKey": {
      },
      "id": "A-b104dfa9-8bc0-4922-a8b6-31b8bb76bfa1"
    }],
    "customContextDataKey": {
    },
    "note": "è¾“å…¥mvelä¸­åŒ¹é…åˆ°çš„éªŒè¯ç ",
    "id": "A-ed359606-8d3d-4d2c-b18c-5a64f25a5142"
  }],
  "id": "SHARE-rule-0d675f9c-30ce-4a7a-b936-4b7849c75dcb",
  "lastUpdateTime": "1728013528969",
  "createTime": "1689214148528",
  "author": {
    "name": "nyehueh"
  },
  "title": "éªŒè¯ç æµä½“äº‘",
  "description": "æµä½“äº‘æ ·å¼æ˜¾ç¤ºæå–çš„éªŒè¯ç ï¼Œç‚¹å‡»é”®å…¥",
  "isEnabled": true,
  "hook": {
  },
  "quit": {
  },
  "ruleSetId": "RS-74fd852c-eeb8-4df7-aad6-3dbb746f258b"
}
###------###
{"type":"rule"}